# time-series

# Задание
Основные цели этого задания:

попрактиковаться в анализе временных рядов,

научиться извлекать дополнительные признаки для прогнозирования временного ряда,

проверять качество модели на отложенной выборке.

Задача: спрогнозировать число пассажиров авиакомпании помесячно.

План:

Загрузите данные из источника по ссылке, ознакомьтесь с ними и подготовьте к аналитике

Найдите и удалите пропуски, если они есть.

Поменяйте тип столбца с временными отсечками в datetime.

Установите индексом данных столбец с временными отсечками и убедитесь, что он монотонно возрастает.

Проанализируйте временной ряд

Оставьте для аналитики лишь с 1952 по 1957 год (включительно).

Реализуйте разложение на компоненты тренда и сезонности. Визуализируйте результат разложения и сделайте выводы.

Есть ли тренд?

Есть ли сезонность и какая она (ежемесячная/ежеквартальная/ежегодная и т.д.)?

Является ли ряд стационарным и почему?

Постройте график, чтобы оценить автокорреляцию и сделайте выводы

У какого сдвига самая высокая автокорреляция?

Подтверждаются ли выводы о наличии тренда графиком автокорреляции?

Подготовьте данные к обучению линейной модели

Напишите функцию, которая будет генерировать новые признаки (календарные признаки, несколько колонок с разными сдвигами, несколько колонок с разными скользящими средними)

Воспользуйтесь наработками из скринкастов.

Добавьте аргумент, который будет отвечать за возможные сдвиги. Это должен быть список, по которому в цикле будет добавляться новая колонка lag_n, где n — число из этого списка, отвечающее за сдвиг.

Добавьте аргумент, который будет отвечать за возможные размеры скользящего среднего. Это должен быть список, по которому в цикле будет добавляться новая колонка rolling_mean_m, где m — число из этого списка, отвечающее за размер окна, по которому вычисляется среднее. Не забудьте, что скользящее среднее нужно сдвигать, чтобы не было «заглядывания в будущее».

Рассчитайте новые признаки с помощью реализованной функции, подав ей на вход произвольные параметры генерации новых признаков.

Удалите наблюдения с пропусками в новых переменных.

Разделите данные на признаки и целевую переменную.

Разделите данные на обучающую и валидационную части. Не забудьте, что валидационная часть должна идти строго после обучающей.

Обучите линейную модель машинного обучения и оцените ее качество

Обучите линейную модель на обучающей части данных.

Рассчитайте значение метрики качества MAE на обучающей и валидационных частях. Если модель работает плохо (метрика выше 20), попробуйте выделить другой набор признаков, вызывая свою функцию с новыми параметрами.

Визуализируйте реальный временной ряд и прогнозные значения. 

Оцените качество модели на отложенной выборке. В качестве отложенной выборки у нас будут наблюдения с 1958 по 1960 год

Возьмите из источника необходимый срез данных.

Подготовьте данные к прогнозированию.

Добавьте признаки с помощью реализованной ранее функции.

Удалите наблюдения с пропусками.

Если после удаления у вас осталось менее 36 наблюдений, откорректируйте срез из пункта 5.а.

 Отделите целевую переменную от признаков.

Постройте прогноз с помощью обученной ранее линейной модели.

Рассчитайте значение метрики качества на отложенной выборке.

Визуализируйте реальный временной ряд и прогнозные значения.

Значение метрики MAE на отложенной выборке должно быть не более 35.

# Задание ПРО
Основные цели этого задания:

научиться определять стационарность ряда статистическими методами

познакомиться с библиотечными решениями для прогнозирования временных рядов и попрактиковаться в их использовании

Задача: спрогнозировать число пассажиров авиакомпании помесячно. В отличие от обычного задания, будем использовать готовые библиотечные решения.

План:

Загрузите данные из источника по ссылке, и подготовьте к прогнозированию. Оставьте только данные с 1952 по 1957 год включительно.

Визуализируйте временной ряд и продублируйте свои выводы из основного задания о том, имеются ли у ряда тренд, сезонность и является ли он стационарным.

Разделите данные на обучающую и валидационную части.

Обучите AR-модель.

Ознакомьтесь с документацией библиотечной модели, которую необходимо использовать в этом задании.

Повторите теорию из видео-урока “Прогнозирование временных рядов” и определите, какой гиперпараметр библиотечной модели отвечает за настройку AR-модели.

Переберите несколько вариантов значений гиперпараметров и выберите лучший по значению метрики MAE на валидационной выборке.

Визуализируйте обучающую и валидационную части данных, а также прогнозные значения, полученные с помощью лучшей AR-модели.

Обучите ARMA-модель

С помощью документации и теории из урока определите, какие гиперпараметры отвечают именно за настройку ARMA-модели.

Переберите несколько вариантов значений гиперпараметров и выберите лучший по значению метрики MAE на валидационной выборке.

Визуализируйте обучающую и валидационную части данных, а также прогнозные значения, полученные с помощью лучшей ARMA-модели.

Обучите ARIMA-модель

Повторите те же этапы, что и в предыдущих шагах. При переборе значений параметра, отвечающего за дифференцирование, перебирайте значения с шагом 1, не перебирайте слишком большие значения (хватит до 3).

Сравните значение параметра, отвечающего за дифференцирование, с необходимым количеством дифференцирований для получения стационарного ряда.

Для того, чтобы понять, является ли ряд стационарным, используется расширенный тест Дики-Фуллера (документация). Выражаясь простым языком, этот статистический тест проверяет гипотезу о том, что ряд является нестационарным. Чем отрицательнее значение критерия, тем сильнее уверенность в том, что гипотезу можно отвергнуть. Если результат теста статистически значимый, то гипотеза отвергается, а ряд считается стационарным. Примеры проведения теста над разными временными рядами можете изучить в статье.

Для того, чтобы понять, сколько раз нужно продифференцировать ряд, чтобы получить стационарный ряд, используйте метод diff и подберите минимальное необходимое количество дифференцирований, после которых согласно тесту Дики-Фуллера временной ряд станет стационарным.

Сравните результат с подобранным в шаге 6 параметром дифференцирования.

Обучите SARIMA-модель

Согласно документации определите, какие гиперпараметры необходмо указать, чтобы модель имела тип SARIMA

Подберите значения гиперпараметров, чтобы получить модель, не уступающую по качеству предыдущим. Число гиперпараметров очень велико, поэтому перебирать их все крайне не рекомендуется. Традиционным способом поиска этих гиперпараметров является метод Бокса-Дженкинса, описанный, например, статье. В рамках этого задания рекомендуется “не закапываться”, а попробовать подобрать гиперпараметры, воспользовавшись следующими рекомендациями:

Параметр сезонности можно определить, исходя из того, какой период сезонности наблюдается на исходных данных. Например, если временной ряд имеет повторяющиеся паттерны каждую неделю, а данные хранятся на уровень дня, параметр сезонности будет принимать значение 7.

При обучении предыдущих моделей мы учитывали сезонность с помощью MA компоненты. Теперь мы будем ее учитывать в гиперпараметрах компоненты сезонности, поэтому гиперпараметр, соответствующий MA компоненте модели можно занулить.

Дифференцирование также теперь достаточно учитывать только для компоненты сезонности.

Выберите лучшую из обученных моделей и оцените ее качество на отложенной выборке
